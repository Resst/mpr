%%%% This is the file with a chapter body from the SPbPU-BCI template  %%%%
%%%% Filled with the article content about TCP and law of minimum

\renewcommand{\chapterEnTitle}{Application of the Law of Minimum for TCP}
\renewcommand{\chapterRuTitle}{Закон минимума и анализ различий для приоритизации регрессионных тестов}
\setcounter{mychapternumber}{1}

\input{template_settings/ch_epigraph} % keep unmodified except for \label{ch-11} after paper acceptance
\begin{abstr}
{\normalfont \abstractnameENG.}
We present the classical VIKOR multi-criteria decision-making method together with two important extensions: interval VIKOR and fuzzy VIKOR. We discuss their theoretical foundations, applicability, advantages and limitations, and provide comparative insight into decision stability under uncertainty. A computational example illustrates interval and fuzzy modifications of VIKOR evaluation and ranking.
\par
{\normalfont \keywordsENG.}
VIKOR, MCDM, interval analysis, fuzzy sets.
\par
{\normalfont \abstractname.}
В работе рассматривается классический метод многокритериального принятия решений VIKOR, а также две его ключевые модификации: интервальный и нечеткий VIKOR. Излагаются теоретические основы методов, области применимости, особенности и ограничения, а также проводится сравнение устойчивости решений в условиях неопределённости. На иллюстративном примере демонстрируется выполнение и результаты интервальной и нечеткой модификации VIKOR.
\par
{\normalfont \keywords.}
VIKOR, многокритериальное принятие решений, интервальный анализ, нечеткие множества.
\end{abstr}

\begin{refsection}[my_folder/my_biblio.bib]

\section{Введение}

Метод VIKOR (\emph{VIseKriterijumska Optimizacija I Kompromisno Resenje}) был предложен Сергием Опричевичем как подход к многокритериальному принятию решений, ориентированный на нахождение \emph{компромиссного решения}, максимально близкого к идеальной точке. В отличие от методов, стремящихся к парето-оптимальным решениям, VIKOR фокусируется на ситуациях, где компромисс между критериями является предпочтительным.

Однако классическая версия метода предполагает, что значения критериев заданы в виде точных чисел. В реальных задачах часто присутствуют различные формы неопределённости: интервальные оценки показателей, экспертные оценки в форме языковых термов, нечеткие треугольные числа и др. Это приводило к необходимости расширить VIKOR.

Существуют две важные модификации:
\begin{itemize}
    \item \textbf{интервальный VIKOR}, предложенный в работе \cite{sayadi2009}, адаптирующий алгоритм к критериям, представленным через интервалы;
    \item \textbf{fuzzy VIKOR}, описанный, например, в работах \cite{wan2013, liu2017}, позволяющий работать с лингвистическими и нечеткими данными.
\end{itemize}

Сравнительный анализ различных версий VIKOR выполнен в статье \cite{chatterjee2016}, где показано, что интервальная и нечеткая модификации позволяют повысить устойчивость решений при наличии неопределенности.

Цель данной работы — систематизировать основные идеи интервальной и нечеткой модификаций VIKOR, показать отличие от классического алгоритма и продемонстрировать работу интервального и нечеткого VIKOR на примере, написанном на языке программирования python.

\section{Обзор метода VIKOR}\label{orig_vikor}

Метод VIKOR относится к классу многокритериальных подходов принятия решений и был предложен Опричевичем как способ получения компромиссного решения в ситуациях, где необходимо учитывать несколько конфликтующих критериев. Первоначально метод создавался для инженерных задач, требующих выбора оптимального варианта среди множества альтернатив с разнородными характеристиками. Основная идея метода заключается в нахождении решения, минимизирующего расстояние до идеальной точки и одновременно обеспечивающего баланс между улучшением средних показателей и уменьшением максимального отклонения. Метод основан на компромиссном программировании, но отличается тем, что явно использует процедуру поиска решения, приемлемого для большинства заинтересованных сторон, что делает его особенно полезным в задачах, предполагающих наличие противоречивых критериев.

VIKOR применяется в ситуациях, где требуется учитывать не только максимальную близость альтернативы к идеальному варианту, но и степень её доминирования по самому неблагоприятному критерию. Поэтому метод получил широкое применение в инженерии, инвестиционном анализе, экологии, управлении проектами и других областях, где невозможно достичь одновременной оптимизации всех целей. Преимуществом метода является способность сочетать стратегии минимизации наихудшего отклонения и максимизации интегральной пользы, что позволяет получать взвешенное компромиссное решение.

\subsection{Математическая постановка задачи}

Пусть задано множество альтернатив \(A = \{A_1, A_2, \dots, A_m\}\), каждая из которых оценивается по набору критериев \(C = \{c_1, c_2, \dots, c_n\}\). Определена матрица оценок \(f_{ij}\), где \(f_{ij}\) — значение альтернативы \(A_i\) по критерию \(c_j\). Для каждого критерия задан тип: выгодный (benefit), для которого большие значения предпочтительны, или затратный (cost), для которого предпочтительны меньшие значения. Также каждому критерию назначен весовой коэффициент \(w_j\), удовлетворяющий условию
\[
\sum_{j=1}^{n} w_j = 1.
\]

Для каждого критерия определяются лучшие и худшие значения среди всех альтернатив. Для выгодных критериев применяются выражения
\[
f_j^{*} = \max_{i} f_{ij}, \qquad f_j^{-} = \min_{i} f_{ij},
\]
а для затратных критериев
\[
f_j^{*} = \min_{i} f_{ij}, \qquad f_j^{-} = \max_{i} f_{ij}.
\]

Затем вычисляются две меры отклонения альтернативы от идеального решения. Первая мера представляет собой взвешенную сумму отклонений:
\[
S_i = \sum_{j=1}^{n} w_j \,\frac{f_j^{*} - f_{ij}}{f_j^{*} - f_j^{-}}.
\]
Вторая мера характеризует максимальное взвешенное отклонение по одному критерию:
\[
R_i = \max_{1\le j\le n} \left\{ w_j \,\frac{f_j^{*} - f_{ij}}{f_j^{*} - f_j^{-}} \right\}.
\]

Для получения компромиссного решения определяется интегральный индекс \(Q_i\):
\[
Q_i = v \cdot \frac{S_i - S^{*}}{S^{-} - S^{*}} + (1-v) \cdot \frac{R_i - R^{*}}{R^{-} - R^{*}},
\]
где
\[
S^{*} = \min_{i} S_i,\quad S^{-} = \max_{i} S_i,\qquad R^{*} = \min_{i} R_i,\quad R^{-} = \max_{i} R_i,
\]
а параметр \(v \in [0,1]\) отражает предпочтения относительно стратегий компромисса. Значение \(v = 0.5\) соответствует равному учёту обеих мер, приближение \(v \to 1\) подчеркивает ориентацию на минимизацию суммарных отклонений, а \(v \to 0\) — на минимизацию наибольшего отклонения.

Итоговое решение определяется альтернативой с минимальным значением \(Q_i\), однако процедура выбора включает дополнительные условия устойчивости. Если различие между лучшими альтернативами недостаточно велико или ранжирование по метрикам \(S\) и \(R\) противоречит индексу \(Q\), формируется не одна альтернатива, а набор компромиссных решений.

\section{Интервальная модификация метода VIKOR}


Как уже упоминалось в \ref{orig_vikor}, классический метод VIKOR предполагает, что оценки всех альтернатив по каждому
критерию представлены точечными значениями. Однако в реальных задачах
многокритериального анализа нередко встречаются ситуации, когда значения
критериев заданы неточно, являются приближёнными или варьируются в некотором
допустимом диапазоне. Такие ситуации типичны для инженерных,
экономических и экологических задач, в которых невозможно получить точные числа
из-за экспертной неопределённости, вариативности данных и измерительных ошибок.

Для учёта неопределённости авторы \cite{sayadi2009} предложили
интервальную модификацию метода VIKOR, в которой вместо точечных значений
используются интервальные оценки
\[
f_{ij} = [\, \underline{f}_{ij},\; \overline{f}_{ij} \,],
\]
где $\underline{f}_{ij}$ и $\overline{f}_{ij}$ обозначают нижнюю и верхнюю границы
возможного значения критерия. Такой подход позволяет работать с более гибкой
моделью данных и принимать решения, устойчивые к колебаниям входной информации.

\subsection{Математическая постановка интервального VIKOR} \label{interval_vikor_formulas}

Пусть задано множество альтернатив $A = \{A_1, \dots, A_m\}$, множество критериев
$C = \{c_1, \dots, c_n\}$ и интервальная матрица оценок
\[
f_{ij} = [\, \underline{f}_{ij},\; \overline{f}_{ij} \,].
\]
Каждый критерий относится к типу \emph{выгодный} или \emph{затратный}, а веса
$w_j$ удовлетворяют условию $\sum_{j=1}^{n} w_j = 1$.

Для интервальных данных определяются \emph{интервальные идеальные} и
\emph{надирные точки}. Для выгодного критерия:
\[
f_j^{*} = 
\left[
\max_i \underline{f}_{ij},\;
\max_i \overline{f}_{ij}
\right], \qquad
f_j^{-} =
\left[
\min_i \underline{f}_{ij},\;
\min_i \overline{f}_{ij}
\right].
\]
Для затратного критерия:
\[
f_j^{*} = 
\left[
\min_i \underline{f}_{ij},\;
\min_i \overline{f}_{ij}
\right], \qquad
f_j^{-} =
\left[
\max_i \underline{f}_{ij},\;
\max_i \overline{f}_{ij}
\right].
\]

Далее необходимо определить интервальные меры отклонения. Интервальный
нормализованный разрыв альтернативы $A_i$ по критерию $c_j$ определяется как
\[
D_{ij} = 
\left[
\frac{f_j^{*\,(\text{low})} - \overline{f}_{ij}}{f_j^{*\,(\text{low})} - f_j^{-\,(\text{high})}},
\quad
\frac{f_j^{*\,(\text{high})} - \underline{f}_{ij}}{f_j^{*\,(\text{high})} - f_j^{-\,(\text{low})}}
\right],
\]
где использование противоположных концов интервалов обеспечивает
\emph{наиболее пессимистичную} и \emph{наиболее оптимистичную} оценки,
согласуясь с подходом Sayadi et al.

Интервальные показатели $S_i$ и $R_i$ вычисляются как:
\[
S_i =
\left[
\sum_{j=1}^{n} w_j\, D_{ij}^{(\text{low})},
\quad
\sum_{j=1}^{n} w_j\, D_{ij}^{(\text{high})}
\right],
\]
\[
R_i =
\left[
\max_{j} w_j\, D_{ij}^{(\text{low})},
\quad
\max_{j} w_j\, D_{ij}^{(\text{high})}
\right].
\]


\subsection{Особенности метода}

Интервальный VIKOR сохраняет структуру исходного метода, но адаптирует
все вычисления к интервальной арифметике. Основные особенности:

\begin{itemize}
	\item вместо точек используются интервалы значений, что делает метод чувствительным к неопределённости;
	\item нормализация использует ``наиболее широкое'' сочетание концов интервалов, что гарантирует корректную оценку в условиях неполных данных;
	\item результаты ранжирования также представляются интервалами и требуют процедуры сравнения интервальных чисел;
	\item метод может порождать частичные или нестрогие порядки, когда интервалы $Q_i$ альтернатив пересекаются.
\end{itemize}

\subsection{Недостатки и ограничения}

Несмотря на преимущества, интервальная модификация имеет ряд недостатков:

\begin{itemize}
	\item усложнение вычислений из-за необходимости поддерживать интервальную арифметику;
	\item увеличение числа случаев, когда альтернативы оказываются несравнимыми из-за пересечения интервалов;
	\item зависимость качества результата от корректного задания интервалов экспертами.
\end{itemize}

Тем не менее модификация доказала свою эффективность в задачах с высокой неопределённостью и стала основой для дальнейших расширений метода, включая fuzzy модификацию \cite{liu2017, wan2013}, о которой пойдет речь в \ref{fuzzy_modification}.

\subsection{Реализация интервальной модификации}

Для практической демонстрации интервальной модификации метода VIKOR был использован
Python-код, реализующий шаги, описанные в работе \cite{sayadi2009}. 

Каждая альтернатива $A_i$ задаётся совокупностью интервальных оценок
$f_{ij}=[\underline{f}_{ij},\overline{f}_{ij}]$, веса критериев удовлетворяют
$\sum_j w_j=1$, а тип критерия $c_j$ определяется значением
$1$ (выгода) или $-1$ (затраты).

\subsubsection*{1. Исходные данные}

В качестве примера рассматриваются четыре альтернативы и три критерия.  
Интервальная матрица оценок имеет вид:

\[
F =
\begin{pmatrix}
	[0.7,0.9] & [0.6,0.8] & [0.8,1.0] \\
	[0.5,0.7] & [0.8,1.0] & [0.6,0.8] \\
	[0.8,1.0] & [0.5,0.7] & [0.7,0.9] \\
	[0.6,0.8] & [0.7,0.9] & [0.5,0.7]
\end{pmatrix}.
\]

Веса критериев:
\[
w = (0.3,\ 0.4,\ 0.3).
\]

Типы критериев:
\[
\text{types} = (1,\ 1,\ -1),
\]
то есть первые два критерия — выгодные, третий — затратный.

\subsubsection*{2. Промежуточные вычисления}

\paragraph{(a) Интервальные идеальные и надирные точки}

Для каждого критерия вычисляются
\[
f_j^{*}=[\max_i \underline f_{ij},\ \max_i \overline f_{ij}],\qquad
f_j^{-}=[\min_i \underline f_{ij},\ \min_i \overline f_{ij}]
\]
для выгодных критериев,
и аналогично с инверсией минимума/максимума — для затратных.

\begin{table}[htbp]
	\centering
	\caption{Идеальная и надирная точки интервалов}
	\begin{tabular}{lcc}
		\toprule
		Критерий & $f_j^*$ & $f_j^-$ \\
		\midrule
		1 & [0.800, 1.000] & [0.500, 0.700] \\
		2 & [0.800, 1.000] & [0.500, 0.700] \\
		3 & [0.500, 0.700] & [0.800, 1.000] \\
		\bottomrule
	\end{tabular}
\end{table}

\paragraph{(b) Интервальные отклонения $D_{ij}$}

Используются формулы интервальной нормализации:
\[
D_{ij}^{(\text{low})}
=
\frac{f_j^{*(\text{low})}-\overline f_{ij}}
{f_j^{*(\text{low})}-f_j^{-(\text{high})}},
\qquad
D_{ij}^{(\text{high})}
=
\frac{f_j^{*(\text{high})}-\underline f_{ij}}
{f_j^{*(\text{high})}-f_j^{-(\text{low})}}.
\]

Полученные интервалы $D_{ij}$:

\[
D_{\text{low}}=
\begin{pmatrix}
	0.0 & 0.0 & 1.0 \\
	1.0 & 0.0 & 0.6 \\
	0.0 & 1.0 & 0.8 \\
	0.0 & 0.0 & 0.4
\end{pmatrix},
\qquad
D_{\text{high}}=
\begin{pmatrix}
	0.6 & 0.8 & 1.0 \\
	1.0 & 0.4 & 0.0 \\
	0.4 & 1.0 & 0.0 \\
	0.8 & 0.6 & 0.0
\end{pmatrix}.
\]

\paragraph{(c) Интервальные агрегированные показатели $S_i$ и $R_i$}

\[
S_i=\Bigl[\sum_j w_j D_{ij}^{(\text{low})},\ \sum_j w_j D_{ij}^{(\text{high})}\Bigr],
\qquad
R_i=\Bigl[\max_j w_j D_{ij}^{(\text{low})},\ \max_j w_j D_{ij}^{(\text{high})}\Bigr].
\]

\[
S=
\begin{pmatrix}
	[0.300, 0.800]\\
	[0.480, 0.460]\\
	[0.640, 0.520]\\
	[0.120, 0.480]
\end{pmatrix},
\qquad
R=
\begin{pmatrix}
	[0.300, 0.320]\\
	[0.300, 0.300]\\
	[0.400, 0.400]\\
	[0.120, 0.240]
\end{pmatrix}.
\]

\paragraph{(d) Интервальные значения $Q_i$}

\[
Q_i = v\,Q_i^{(S)} + (1-v)\,Q_i^{(R)},
\qquad v=0.5.
\]

Полученные интервалы:

\[
Q =
\begin{pmatrix}
	[0.000,\ 0.857] \\
	[0.243,\ 0.571] \\
	[1.000,\ 0.794] \\
	[0.000,\ 0.479] 
\end{pmatrix}.
\]

\subsubsection*{3. Результаты и анализ}

Поскольку в работе \cite{sayadi2009} не предлагается строгого правила упорядочивания интервальных значений $Q_i$, в настоящей реализации используется ранжирование по центрам интервалов $Q_i^{\text{center}} = \tfrac{1}{2}\bigl(Q_i^{(\text{low})} + Q_i^{(\text{high})}\bigr)$. Такой подход согласуется с классической версией метода VIKOR, где используются скалярные значения $Q_i$, и обеспечивает нейтральный выбор внутри интервала без предпочтения пессимистичного или оптимистичного сценария.

\begin{table}[htbp]
	\centering
	\caption{Интервальные метрики $S$, $R$ и $Q$ для альтернатив}
	\begin{tabular}{|l|l|l|l|l}
		\toprule
		Альтернатива & $S_i$ & $R_i$ & $Q_i$ & $Q_i^{\text{center}}$ \\
		\midrule
		A1 & [0.300, 0.800] & [0.300, 0.320] & [0.000, 0.857] & 0.429 \\
		A2 & [0.480, 0.460] & [0.300, 0.300] & [0.243, 0.571] & 0.407 \\
		A3 & [0.640, 0.520] & [0.400, 0.400] & [1.000, 0.794] & 0.897 \\
		A4 & [0.120, 0.480] & [0.120, 0.240] & [0.000, 0.479] & 0.239 \\
		\bottomrule
	\end{tabular}
\end{table}

\begin{table}[htbp]
	\centering
	\caption{Ранжирование альтернатив по метрике $Q$}
	\begin{tabular}{lc}
		\toprule
		Ранжирование & Лучшая альтернатива \\
		\midrule
		A4 $\rightarrow$ A2 $\rightarrow$ A1 $\rightarrow$ A3 & A4 \\
		\bottomrule
	\end{tabular}
\end{table}

\section{Нечёткая (fuzzy) модификация метода VIKOR} \label{fuzzy_modification}
В классическом подходе оценочные матрицы и веса являются точными числами, интервальная работает с интервалами. Нечеткая (fuzzy) модификация VIKOR расширяет эти подходы и использует нечеткие числа (лингвистические оценки) для описания неясных, неточных или субъективных данных. Например, эксперт может оценивать критерий как "Высокий", "Средний" или "Низкий", эти термины аппроксимируются нечеткими числами. 

Нечёткое число -- это обобщение обычного (точного) числа, которое позволяет учитывать неопределенность или размытость в значении. Иначе говоря, нечеткое число -- это число, у которого нет одной точной величины, но есть область возможных значений с разной степенью уверенности. Выделяют треугольные и трапециевидные нечеткие числа. Треугольные нечеткие числа $\tilde f=(l,m,h)$, где $l\le m\le h$, наиболее популярны на практике: они просты в использовании и часто задают лингвистические шкалы (см. табл. \ref{lingtab}). Треугольное число задается тройкой $(l,m,h)$ с монотонным ростом функции принадлежности: $l$ -- нижняя граница, $m$ -- среднее пиковое значение (наиболее вероятное), $h$ – верхняя граница. Выделяют также трапециевидное число, которое задается примерно также, но имеет два средних значения, задающих пиковый промежуток.

\begin{table*}[htbp]
	\centering
	\caption{Лингвистическая шкала.}
	\begin{tabular}{|l|l|}
		\hline
		Лингвистическая оценка & Нечеткое представление \\ \hline
		Очень Плохо & (0, 0, 1)  \\ \hline
		Плохо & (0, 1, 3) \\ \hline
		Средне & (1, 3, 5) \\ \hline
		Хорошо & (3, 5, 7) \\ \hline
		Очень хорошо & (5, 7, 9) \\ \hline
		Отлично & (7, 9, 10) \\ \hline
	\end{tabular}
	\label{lingtab}
\end{table*}

Благодаря нечеткости метод может учитывать разброс мнений, повышает устойчивость результатов при неопределенности и близок к реальным условиям принятия решений. Для удобства дальше будем работать с треугольными числами.

Для треугольных чисел выделяют следующие математические операции:

Сумма треугольных чисел: $\sum_{i=1\oplus}^{n} \tilde{N_i} = (\sum_{i=1}^{n} l_i, \sum_{i=1}^{n} m_i, \sum_{i=1}^{n} h_i)$.

Сумма треугольного числа и скаляра: $\tilde{N}\oplus K = (l + K, m+K,h+K)$.

Вычитание: $\tilde{N_1} \ominus \tilde{N_2} = (l_1 - r_2, m_1 - m_2, r_1 - l_2)$.

Вычитание скаляра: $\tilde{N} - K = (l - K, m - K, h - K)$.

Умножение на скаляр: $K\times \tilde{N} = (K\times l, K\times m, K\times h)$, для $K \ge 0$

Умножение: $\tilde{N_1} \otimes \tilde{N_2} = (l_1 \times l_2, m_1 \times m_2, h_1 \times h_2)$.

Деление на скаляр: $ \frac{\tilde{N}}{K} = (\frac{l}{K}, \frac{m}{K}, \frac{h}{K})$.

Оператор MAX: $\underset{i}{MAX} \tilde{N_i} = (\underset{i}{max} l_i,\underset{i}{max} m_i,\underset{i}{max} h_i)$.

Оператор MIN: $\underset{i}{MIN} \tilde{N_i} = (\underset{i}{min} l_i,\underset{i}{min} m_i,\underset{i}{min} h_i)$.




\subsection{Алгоритм Fuzzy VIKOR}
Алгоритм Fuzzy VIKOR расширяет классический, заменяя арифметику на нечеткую и вводя шаг дефаззификации (defuzzification). Основные этапы следующие:

\begin{enumerate}
	\item Формирование нечеткой матрицы. Эксперты дают лингвистические оценки альтернатив по каждому критерию и/или важности критериев. Эти оценки переводятся в нечеткие числа $\tilde f_{ij}=(a_{ij},b_{ij},c_{ij})$ (например, через заранее установленную таблицу соответствия).
	\item Определение весов критериев. Веса $w_j$ либо даны как четкие, либо также как нечеткие числа (например, через консенсус экспертов). Веса нормализуют или агрегируют (методом комплексного среднего, разрежение агрегации и т.п.) в одну нечеткую величину для каждого критерия.
	\item Нечеткие идеальная и надирная точки. Для каждого критерия $j$ вычисляют нечеткую идеальную (наилучшую) $\tilde f_j^*$ и надирную (наихудшую) $\tilde f_j^{\circ}$.
	
	$\tilde{f_i^*} = \underset{j}{MAX} \tilde{f_{ij}}$, $\tilde f_j^{\circ} = \underset{j}{MIN} \tilde{f_{ij}}$ при максимизации критерия.
	
	$\tilde{f_i^*} = \underset{j}{MIN} \tilde{f_{ij}}$, $\tilde f_j^{\circ} = \underset{j}{MAX} \tilde{f_{ij}}$ при минимизации критерия.
	
	\item Нормализация (нечеткие разности). Вычисляют разности для каждой альтернативы $i$ по каждому критерию $j$:
	
	$\tilde{d_{ij}} = (\tilde{f_i} \ominus \tilde{f_{ij}})/(h_i^* - l_i^{\circ})$ при максимизации,
	
	$\tilde{d_{ij}} = (\tilde{f_{ij}} \ominus \tilde{f_{i}})/(h_i^{\circ} - l_i^{*})$ при минимизации,
	
	\item Вычисление S и R (нечеткие показатели). Для каждой альтернативы $j$ вычисляются две агрегированные нечеткие величины:
	
	$\tilde{S_j}=\sum_{i=1\oplus}^{n}(\tilde{w_i} \otimes \tilde{d_{ij}}) $
	
	$\tilde{R_j}=\underset{i}{MAX}(\tilde{w_i} \otimes \tilde{d_{ij}}) $
	где $\tilde{S}$ выражает групповую полезность, $\tilde{R}$ -- индивидуальное сожаление.
	
	\item Вычисление Q (нечеткий индекс). Аналогично классическому варианту вычисляют нечеткий индекс компромисса:
	
	$\tilde{Q_j} = \mu(\tilde{S_j} \ominus \tilde{S^*}) / (S^{\circ h} - S^{*l}) \oplus (1-\mu)(\tilde{R_j} \ominus \tilde{R^*}) / (R^{\circ h} - R^{*l})$,
	
	где $\tilde{S^*} = \underset{j}{MIN} \tilde{S_j}$, $\tilde{S^{\circ h}} = \underset{j}{max} \tilde{S_j^h}$, $\tilde{R^*} = \underset{j}{MIN} \tilde{R_j}$, $\tilde{R^{\circ h}} = \underset{j}{max} \tilde{R_j^h}$, $\mu$ задается пользователем VIKOR и выражает компромисс между стратегиями S и R. 
	
	\item Core ranking. На данном этапе можно произвести первое ранжирование (core ranking) по среднему значению $Q^b$.
	\item Fuzzy ranking. Для нечеткого ранжирования (fuzzy ranking) нужно подтвердить ранжирование из предыдущего пункта. Для того, чтобы подтвердить ранг i-го объекта нужно, чтобы для любого j-го объекта с рангом меньше i-го выполнялось условие $\tilde{Q_i^l} \le \tilde{Q_j^l} \& \tilde{Q_i^m} \le \tilde{Q_j^m} \& \tilde{Q_i^h} \le \tilde{Q_j^h}$.
	
	\item Дефаззификация. Чтобы сравнивать альтернативы, преобразуют нечеткие $\tilde{S_i},\tilde{R_i},\tilde{Q_i}$ в обычные числовые значения. Обычно используют центроиду треугольного числа: для $\tilde Q_i=(l, m, h)$ задают $Q_i^\mathrm{cr}=(l+m+h)/3$. Также может использоваться формула $Q_i^\mathrm{cr}=(l+2m+h)/4$. Аналогично получают $S_i^\mathrm{cr},R_i^\mathrm{cr}$. Этот этап вводит дополнительную процедуру: разные методы дефаззификации могут дать чуть разные ранги, поэтому его выбор влияет на результат.
	\item Ранжирование альтернатив. Альтернативы упорядочивают по возрастанию дефаззифицированных значений $S_i^\mathrm{cr}, R_i^\mathrm{cr}, Q_i^\mathrm{cr}$. Мера $Q^\mathrm{cr}$ считается основной: чем меньше $Q_i^\mathrm{cr}$, тем ближе альтернатива к идеальному.
	\item Выбор компромиссного решения. По тем же правилам, что и в классическом VIKOR: выбирают альтернативу с минимальным $Q_i^\mathrm{cr}$, если выполняются условия достаточного преимущества и стабильности. То есть требуется, чтобы разница $Q_{(2)}^\mathrm{cr}-Q_{(1)}^\mathrm{cr}$ превысила порог $1/(m-1)$ ($m$ – число альтернатив) и лучшая альтернатива была хороша хотя бы по $S$ или $R$. В противном случае выводят несколько компромиссных решений аналогично классической схеме.
\end{enumerate}

Дополнительно может вычисляться уступка (trade-off). Для этого вычисляется значение $tr_i=(D_k*w_i)/(D_i*w_k)$, где $i$ - индекс текущего критерия, $k$ - задаваемый индекс, $i \neq k$. $D_i =f_i^{*h} - f_i^{\circ l}$ для максимизируемого критерия, $D_i =f_i^{\circ h} - f_i^{*l}$ для минимизируемого критерия. Уступка может устанавливаться вручную. Далее вычисляются новые веса по формуле $w’_i=|(D_i * w^\mathrm{cr} * tr_i) / D_k|$. После этого пункты D-K повторяются и определяется новый ранг в соответствии с уступкой. 




\subsection{Реализация fuzzy модификации на Python}

Для практической демонстрации нечеткой модификации метода VIKOR реализован класс \texttt{FuzzyVIKOR}, описывающий процедуру, предложенную в работе Opricovic (2011)~\cite{Opricovic2011}. Ниже перечислены ключевые шаги
реализации и их соответствие формальному описанию метода.

\begin{enumerate}
	\item Представление данных: каждая альтернатива $A_i$ задается набором треугольных нечетких чисел (TFN) по каждому критерию. Каждое число -- массив длины 3.
	
	Входные данные в коде представлены как трёхмерный массив \texttt{matrix} формы $(m,n,3)$, где m -- число альтернатив, n -- число критериев.
	
	\item Идеальная и надирная точки: для каждого критерия вычисляются покомпонентно:
	\begin{lstlisting}
		ideal_point = np.zeros((n, 3))
		nadir_point = np.zeros((n, 3))
		for j in range(n):
		for k in range(3):
		if benefit_criteria[j]:
			ideal_point[j, k] = np.max(matrix[:, j, k])
			nadir_point[j, k] = np.min(matrix[:, j, k])
			else:
			ideal_point[j, k] = np.min(matrix[:, j, k])
			nadir_point[j, k] = np.max(matrix[:, j, k])
	\end{lstlisting}

	\item Нормализация нечетких расстояний: для каждой альтернативы и критерия формируется тройка компонент.
	\begin{lstlisting}
		normalized = np.ndarray((m, n, 3))
		for i in range(m):
			for j in range(n):
				for k in range(3):
				if benefit_criteria[j]:
					normalized[i, j, k] = (ideal_point[j, k] - matrix[i, j, 2 - k]) / (ideal_point[j, 2] - nadir_point[j, 0])
				else:
					normalized[i, j, k] = (matrix[i, j, k] - ideal_point[j, 2 - k]) / (nadir_point[j, 2] - ideal_point[j, 0])
	\end{lstlisting}
	В коде нормализованные значения сохраняются в массиве \texttt{normalized}.
	\item Вычисление нечетких $S$ и $R$: покомпонентное умножение нечетких весов \(\tilde w_j\)
	и нормализованных расстояний:
	\begin{lstlisting}
		S_values = np.zeros((m, 3))
		R_values = np.zeros((m, 3))
		
		for i in range(m):
			for k in range(3):
				s_val = 0
				r_val = -np.inf
				for j in range(n):
					cur_val = weights[j, k] * normalized[i, j, k]
					s_val += cur_val
					if (cur_val > r_val):
						r_val = cur_val
				S_values[i, k] = s_val
				R_values[i, k] = r_val
	\end{lstlisting}
	В реализации это массивы \texttt{S\_values} и \texttt{R\_values} размерности $(m,3)$.
	\item Вычисление $Q$:
	\begin{lstlisting}
		S_star = np.min(S_values, axis=0)   # array [Sl_min, Sm_min, Sr_min]
		S_bar_r = np.max(S_values[:, 2])    # scalar = max over Sr
		R_star = np.min(R_values, axis=0)
		R_bar_r = np.max(R_values[:, 2])
		
		# 4. Расчёт Q
		print("4. Расчет значений Q...")
		Q_values = np.zeros((m, 3))
		for i in range(m):
		for k in range(3):
		S_part = (S_values[i, k] - S_star[2 - k]) / (S_bar_r - S_star[0])
		R_part = (R_values[i, k] - R_star[2 - k]) / (R_bar_r - R_star[0])
		Q_values[i, k] = v * S_part + (1 - v) * R_part
	\end{lstlisting}
	\item Дефаззификация: треугольные числа переводятся в скаляры:
	\begin{lstlisting}
		crisp_Q = np.zeros(m)
		crisp_R = np.zeros(m)
		crisp_S = np.zeros(m)
		for i in range(m):
			crisp_Q[i] = (Q_values[i, 0] + 2 * Q_values[i, 1] + Q_values[i, 2]) / 4
			crisp_R[i] = (R_values[i, 0] + 2 * R_values[i, 1] + R_values[i, 2]) / 4
			crisp_S[i] = (S_values[i, 0] + 2 * S_values[i, 1] + S_values[i, 2]) / 4
	\end{lstlisting}
	\item В коде реализована проверка условий \emph{acceptible advantage} и \emph{stability} и механизм 
	\emph{trade-off} (уступки) с пересчётом весов и повторным выполнением шагов агрегации и ранжирования.
	
	
\end{enumerate}

\subsubsection{Замечания по параметрам реализации}

\begin{itemize}
	\item \texttt{weights} в реализации ожидаются в виде TFN весов формы $(n,3)$. Если исходные веса заданы как скаляры, их
	можно расширить до TFN, положив все три компоненты равными.
	\item Параметр $v\in[0,1]$ задаёт стратегию компромисса (в коде — аргумент \texttt{v}).
	\item Механизм уступки (trade-off) в коде позволяет задать либо вектор \texttt{tr\_custom\_values}, либо вычислить его автоматически,
	после чего пересчитываются веса и алгоритм прогоняется повторно.
\end{itemize}

Алгоритм был запущен на тестовом наборе (6 альтернатив, 4 критерия, детали см. исходный \texttt{.ipynb}). Для данного прогона получены следующие истинные идеальные и надирные точки (покомпонентно, L/M/U):

\begin{table}[htbp]
	\centering
	\caption{Идеальная и надирная точки (TFN) для примера}
	\label{tab:fuzzy-ideal-nadir}
	\begin{tabular}{|l|l|l|}
		\toprule
		Критерий $j$ & $\tilde f_j^{*}$ & $\tilde f_j^{-}$ \\
		\midrule
		1 (затратный) & $(20.00,\;21.06,\;24.00)$ & $(44.54,\;46.89,\;56.27)$ \\
		2 (выгодный)  & $(3.26,\;4.08,\;4.08)$    & $(2.25,\;2.50,\;2.62)$ \\
		3 (затратный) & $(6.00,\;6.00,\;6.00)$    & $(60.00,\;62.00,\;68.00)$ \\
		4 (затратный) & $(0.00,\;0.00,\;0.00)$    & $(10.00,\;10.00,\;10.00)$ \\
		\bottomrule
	\end{tabular}
\end{table}

Из прогона выведены итоговые показатели (дефаззифицированные) и решение:
\begin{itemize}
	\item Допустимое превосходство (acceptable\_advantage): \textbf{True}.
	\item Допустимая стабильность (acceptable\_stability): \textbf{True}.
	\item Компромиссное решение: \textbf{альтернатива A3}.
\end{itemize}


\subsubsection{Краткий анализ результатов}

\begin{itemize}
	\item Модификация корректно обрабатывает неопределённость оценок (TFN) — итоговое ранжирование учитывает и
	средние, и крайние оценки альтернатив.
	\item Возможность задания \texttt{tr\_custom\_values} и перерасчёта весов позволяет моделировать различные сценарии trade-off
	и смотреть, как они влияют на итоговый компромисс.
	\item Важно учитывать метод дефаззификации: переход от TFN к скалярам существенно влияет на \(S_i,R_i,Q_i\).
\end{itemize}

\subsubsection{Псевдокод реализованного алгоритма (кратко)}
\begin{enumerate}
	\item Ввести \(\tilde f_{ij}\) и \(\tilde w_j\) (TFN).
	\item Для каждого $j$ вычислить $\tilde f_j^{*}$ и $\tilde f_j^{-}$.
	\item Для всех $i,j$ получить $\tilde d_{ij}$ по формулам (L,M,U).
	\item Вычислить $\tilde S_i$ и $\tilde R_i$, а потом и $Q_i$ покомпонентно.
	\item Дефаззифицировать $\tilde S_i,\tilde R_i$ в скаляры $S_i,R_i$.
	\item Посчитать $S^{*}, S^{-}, R^{*}, R^{-}$ и скалярный $Q_i$; ранжировать.
	\item Проверить условия acceptable advantage, acceptable stability и, при необходимости,
	применить trade-off (пересчитать веса и повторить шаги с ранжированием).
\end{enumerate}


\subsection{Сравнение подходов}
Для классического VIKOR, интервальной и fuzzy модификаций были вычислены ранги для похожих данных. В качестве исходных данных были взяты данные в виде нечетких чисел. Для интервальной модификации были взяты 1 и 3 значения из нечеткого числа. Для классического метода было взято 2 значение. Результаты представлены на таблице \ref{tab:vikor-results}. 

\begin{table}[h]
  \centering
  \caption{Результаты ранжирования для разных методов VIKOR}
  \label{tab:vikor-results}
  \begin{tabular}{|l|l|l|l|}
    \toprule
    Альтернатива & Классический & Интервальный & Fuzzy  \\ \hline
    А1 & 5 & 5 & 5  \\ \hline
    А2 & 4 & 4 & 4 \\ \hline
    А3 & 1 & 1 & 2 \\ \hline
    А4 & 6 & 6 & 6 \\ \hline
    А5 & 3 & 3 & 1 \\ \hline
    А6 & 2 & 2 & 3 \\ \hline
  \end{tabular}
\end{table}

По таблице видно, что внесение неопределенности может влиять на ранжирование, а значит модификации VIKOR могут применяться в условиях, когда точное значение не известно.

\subsection{Краткий анализ результатов}


\section{Выводы}
В данной работе проведено систематическое исследование метода многокритериального принятия решений VIKOR и двух его ключевых модификаций, предназначенных для работы в условиях неопределённости: интервального VIKOR и нечёткого (fuzzy) VIKOR.

Основные результаты и положения, представленные в работе, могут быть сформулированы следующим образом:

Классический метод VIKOR, являясь эффективным инструментом для поиска компромиссного решения, оперирует точечными данными. В реальных условиях экспертные оценки, показатели эффективности и веса критериев часто носят неточный или качественный характер. Представленные модификации успешно решают эту проблему: интервальный VIKOR работает с диапазонами значений, а fuzzy VIKOR — с лингвистическими переменными, представленными треугольными нечёткими числами, что значительно повышает адекватность моделирования реальных задач.

В работе подробно изложены математические постановки, формулы и вычислительные процедуры для всех трёх версий метода. Особое внимание уделено ключевым особенностям расширений: использованию интервальной арифметики, операциям с нечёткими числами и этапу дефаззификации, который необходим для финального ранжирования альтернатив в fuzzy VIKOR.

Для обеих модификаций разработаны и представлены программные реализации на языке Python, что подтверждает практическую применимость методов. На конкретных примерах продемонстрирован полный вычислительный цикл — от задания интервальных и нечётких входных данных до получения итогового ранжирования и проверки условий приемлемости компромиссного решения (acceptable advantage и acceptable stability).

Сравнение итогов ранжирования, полученных классическим, интервальным и нечётким VIKOR на сопоставимых данных, выявило важный факт: учёт неопределённости может изменять порядок предпочтения альтернатив. Как показано в таблице результатов, альтернатива A5, занимающая 3-е место в классической и интервальной версиях, выходит на 1-е место при использовании fuzzy VIKOR. Это наглядно иллюстрирует, что игнорирование размытости исходных данных может привести к выбору неоптимального с точки зрения реального контекста решения.

Рассмотренные модификации VIKOR особенно востребованы в областях с высокой степенью неопределённости: управление проектами, экологический менеджмент, инвестиционный анализ, оценка инновационных технологий. В качестве перспективных направлений дальнейших исследований можно выделить: развитие гибридных моделей, сочетающих интервальный и нечёткий подходы; интеграцию VIKOR с методами машинного обучения для обработки больших объёмов неструктурированных данных; а также углублённое изучение влияния различных стратегий дефаззификации и методов сравнения интервалов на устойчивость итогового решения.

Таким образом, работа подтверждает, что интервальный и нечёткий VIKOR являются мощными и необходимыми расширениями классического метода, которые сохраняют его концептуальные преимущества — ориентацию на поиск взвешенного компромисса — и в то же время значительно расширяют сферу его применимости за счёт возможности работы с неточной и качественной информацией. Это делает данные методы ценным инструментом для аналитиков и лиц, принимающих решения, в сложных и неопределённых условиях современного мира.

\section*{Библиографический список}
\printbibliography
\end{refsection}
\newpage % keep unmodified
